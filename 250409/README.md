# 250409 산업용 통신

## 산업용 통신 구조

### Digital I/O 통신

- 전기의 전압을 활용하여 기기간 전류를 입력 또는 출력하는 형식
- NPN / PNP 에 따라 제어 타입이 바뀌며, 전압의 크기에 따라 기준 전압이 바뀐다.

### 시리얼(Serial) 통신

- 가장 범용적인 통신 방식
- 케이블에 따라 다양한 통신의 종류가 있다 RS 232, RS 485, USB 통신 등
- 적은 수의 케이블로 데이터를 전송 가능
- 직렬 통신은 순차적으로 데이터를 전달, 병렬은 한번에 전송
- TX, RX만 있으면 됨 (물론 실제로는 Vcc나 GND까지 4가닥 정도)

![image.png](image.png)

### 동기식 전송, 비동기식 전송

- 동기식은 시작과 끝을 알리는 클록(Clock) 신호가 추가(물리석인 배선 추가)
- 시작할 때 시작한다고 알려줌
- 비동기식은 Start Bit와 Stop Bit로서 시작과 끝을 구성

- 동기식은 데이터 오류가 적음, 데이터 통신 빠름, 물리적인 배선이 필요, 최소 2개의 라인 필요, 회로도가 복잡
- 비동기식은 배선이 간편, 데이터 손실 위험(요즘은 손실 위험이 적다), 통신 속도가 상대적으로 느리다(고용량이 아닌 일반적인 상황에서는 그렇게 큰 문제는 아니다)

- 저비용의 간단한 구조 및 기술의 발달로 비동기식이 범용적으로 사용
- RS 232, 485 통신이 대표적인 비동기식 통신 방식

| 항목 | 동기식 전송 방식 | 비동기식 전송 방식 |
| --- | --- | --- |
| 통신 속도 | 고속 | 저속 |
| 회로 복잡도 | 복잡 | 복잡 |
| 구축 비용 | 고가 | 저가 |
| 동기 제어 방식 | 클럭 동기 | Start/Stop Bit |
| 전송 단위 | 블록 단위 전송 | 문자 단위 전송 |
| 적용 예 | 전화, ATM, 데이터 통신망 | RS-232, 485 |

### RS-232 통신 규격

- 왜 이렇게 단자가 많아요?
    
    → 나머지 핀들은 범용적으로 쓸 수 있도록 그냥 만들어 놓은 것
    
- 가장 보편적인 Serial 통신 규격
- 전압 레벨에 따라 A, B, C 타입이 존재 (보편적으로 RS-232C를 사용 : 24V)
- 전기적 신호 및 물리적인 핀에 의한 제어 신호를 규정하나 프로토콜은 정의하지 않음
    
    → 따로 프로토콜은 없고 사용자가 정의하기 나름
    
- 전이중(Full Duplex) 통신 방식 지원
    
    → 송신도 할 수 있고 수신도 할 수 있음
    
- 장치간 다중 연결이 가능하지 않음
- TX 라인, RX 라인, GND 라인 3선으로 통신이 이루어진다 → + Vcc 까지 많이 사용

### 용어 정리 1

- 단방향 통신 (Simplex, One Way)
    - 단방향으로만 전송 가능, 수신측에서 송신측으로 응답 불가능
- 양방향 통신, 이중화 통신 (Duplex, Two-way)
    - 반이중 전송방식 (Half Duplex)
    - 전이중 전송방식 (Full Duplex)
- 반이중 전송 방식 (Half Duplex)
    - 통신은 가능하나, 특정 시점에는 한 방향으로 전송이 가능
    송신과 수신이 동시에 이루어지지 않음
- 전이중 전송 방식 (Full Duplex)
    - 양방향으로 동시에 데이터 전송이 가능
    전용으로 할당된 채널을 통해 양단간 점대점(Point to Point) 연결로 동시적 통신이 가능

### RS-485/422 통신 규격

- RS-422 통신 규격
    - 하나의 전송 객체에 대하여 다중 수신 객체를 지정할 수 있다.
    - 정의된 프로토콜은 없지만 다중 객체에 대한 주소 지정(**어드레싱**)이 필요하다.
    - 전이중(Full Duplex)를 지원하며, 2개의 TX 라인과 2개의 RX 라인, GND 라인으로 총 5개의 라인으로 통신한다.
- RS-485 통신 규격
    - RS-422의 확장버전
    - 한 라인에 구축된 모든 장비들이 송수신을 할 수 있다.
    - 반이중(Half Duplex)과 전이중(Full Duplex)통신을 모두 지원한다.
    - 반이중 통신의 경우 3선, 전이중 통신의 경우 5선이 필요하다.

| 항목 | RS232C | RS423 | RS422 | RS485 |
| --- | --- | --- | --- | --- |
| 동작 모드 | Single-Ended | Single-Ended | Differential | Differential |
| 최대 Driver/Receiver 수 | 1 Driver / 1 Receiver | 1 Driver / 10 Receiver | 1 Driver / 32 Receiver | 32 Driver / 32 Receiver |
| 최대 송신거리 | 약 15m | 약 1.2km | 약 1.2km | 약 1.2km |
| 최고 통신속도 | 20kb/s | 100kb/s | 10 Mb/s | 10 Mb/s |
| 지원 전송방식 | Full Duplex | Full Duplex | Full Duplex | Half Duplex |

### Serial USB 통신

- 일반적으로 PC에서 볼 수 있는 USB Port를 활용하는 통신
- 키보드, 마우스 등 Port에 단순 삽입만 하면 됨으로 범용성이 뛰어나다.
- 일반적으로 USB 2.0의 경우 RX TX VCC GND, 4선을 사용한다.

### 용어정리 2

- BPS (Bit Per Second)
    - 1초에 보낼 수 있는 비트(Bit)의 양을 의미한다.
    - 9600 BPS는 1초에 9600개의 Bit 신호를 보낼 수 있다.
- 보오 레이트 (Baud Rate)
    - 초당 보내야 하는 의미있는 데이터 수(Pulse 의 양) 또는 초당 변조 횟수(Frequency)
    - 일반적인 PC에서 Baud Rate와 BPS는 동일하다.
    - 사용자가 정의한 수신 데이터의 크기가 8 bit (1 Byte), BPS가 9600 일 때 Baud Rate는 아래와 같다.
    
    ```
    Baud Rate = 9600 BPS / 8 Bit = 1200 Baud Rate
    비트주기 = 1200Hz 또는 1/1200 * 1,000,000(us) = 833.3(us)
    ```
    
- 시작 비트, 스톱 비트 (Strat Bit, Stop Bit)
    - 데이터 비트의 범위 식별 및 비동기식 통신 방식에서 시작과 끝을 결정하는 신호
    - 실제 데이터는 시작 비트 뒤에 삽입되어 전송된다.
    - 사전 결정된 규칙에 따라 실제 데이터 전송 후 Parity Bit 후 Stop Bit로 통신이 종료된다.
    - ASCII Code 구성
        - 7 Bit(문자 주소) + 1 Bit(에러 검출)

![image.png](image%201.png)

- 패리티 비트 (Parity Bit)
    - 데이터의 구조 및 오류를 체크하는 신호다.
    - 짝수(Even), 홀수(Odd), 마크(Mark), 스페이스(Space) 패리티 비트 등이 존재한다.
    - 짝수 패리티와 홀수 패리티 비트가 범용적으로 사용된다.
    - 데이터의 비트의 1의 개수를 체크하여 짝수일 때, 혹은 홀수일 때, 설정한 짝수/홀수 패리티 비트가 활성화 되어 비트의 짝수 / 홀수를 맞추고 데이터의 오류를 체크한다.
    
    | 7 bits of data | (count of 1-bits) | 8 bits including parity |  |
    | --- | --- | --- | --- |
    |  |  | even | odd |
    | 0000000 | 0 | 00000000 | 00000001 |
    | 0101001 | 3 | 10100011 | 10100010 |
    | 1101001 | 4 | 11010010 | 11010011 |
    | 1111111 | 7 | 11111111 | 11111110 |